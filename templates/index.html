{% extends "base.html" %}

{% block title %}Home - Presentation Design System{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Hero Section -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">
            –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π
        </h1>
        <p class="text-xl text-gray-600">
            –í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ Google Slides –∏–ª–∏ —Ç–µ–∫—Å—Ç –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏
        </p>
    </div>

    {% if error %}
    <!-- Error Message -->
    <div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6" role="alert">
        <div class="flex items-center">
            <span class="text-xl mr-2">‚ö†Ô∏è</span>
            <span>{{ error }}</span>
        </div>
    </div>
    {% endif %}

    <!-- Processing Form -->
    <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
        <form action="/process" method="POST" class="space-y-6">
            <!-- Input Method Selector -->
            <div class="mb-6">
                <label class="block mb-3 text-sm font-medium text-gray-900">
                    –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –≤–≤–æ–¥–∞:
                </label>
                <div class="flex gap-4">
                    <label class="flex items-center cursor-pointer">
                        <input type="radio" 
                               name="input_method" 
                               value="url" 
                               checked 
                               onchange="toggleInputMethod()"
                               class="w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 focus:ring-purple-500">
                        <span class="ml-2 text-sm font-medium text-gray-900">Google Slides URL</span>
                    </label>
                    <label class="flex items-center cursor-pointer">
                        <input type="radio" 
                               name="input_method" 
                               value="text" 
                               onchange="toggleInputMethod()"
                               class="w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 focus:ring-purple-500">
                        <span class="ml-2 text-sm font-medium text-gray-900">–í—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç</span>
                    </label>
                </div>
            </div>

            <!-- URL Input Container -->
            <div id="urlInputContainer">
                <label for="presentation_url" class="block mb-2 text-sm font-medium text-gray-900">
                    Google Slides URL
                </label>
                <input type="url" 
                       id="presentation_url" 
                       name="presentation_url"
                       class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
                       placeholder="https://docs.google.com/presentation/d/...">
                <p class="mt-2 text-sm text-gray-500">
                    –í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à—É –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é Google Slides
                </p>
            </div>

            <!-- Text Input Container -->
            <div id="textInputContainer" class="hidden">
                <label for="presentation_text" class="block mb-2 text-sm font-medium text-gray-900">
                    –¢–µ–∫—Å—Ç –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏
                </label>
                <textarea id="presentation_text" 
                          name="presentation_text"
                          rows="15"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
                          placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –≤–∞—à–µ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏...

–°–ª–∞–π–¥ 1
–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–µ—Ä–≤–æ–≥–æ —Å–ª–∞–π–¥–∞
–û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç

–°–ª–∞–π–¥ 2
–ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–∞–π–¥–∞
..."></textarea>
                <p class="mt-2 text-sm text-gray-500">
                    –í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç. –°–ª–∞–π–¥—ã –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–°–ª–∞–π–¥ 1", "–°–ª–∞–π–¥ 2" –∏ —Ç.–¥.
                </p>
            </div>

            <button type="submit"
                    class="w-full text-white bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 focus:ring-4 focus:outline-none focus:ring-purple-300 font-medium rounded-lg text-sm px-5 py-3">
                üìù –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä
            </button>
        </form>
    </div>

    <script>
    function toggleInputMethod() {
        const inputMethod = document.querySelector('input[name="input_method"]:checked').value;
        const urlContainer = document.getElementById('urlInputContainer');
        const textContainer = document.getElementById('textInputContainer');
        const urlInput = document.getElementById('presentation_url');
        const textInput = document.getElementById('presentation_text');
        
        if (inputMethod === 'url') {
            urlContainer.classList.remove('hidden');
            textContainer.classList.add('hidden');
            urlInput.required = true;
            textInput.required = false;
        } else {
            urlContainer.classList.add('hidden');
            textContainer.classList.remove('hidden');
            urlInput.required = false;
            textInput.required = true;
        }
    }
    </script>

    <!-- Features -->
    <div class="grid md:grid-cols-3 gap-6">
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl mb-3">‚ö°</div>
            <h3 class="font-bold text-lg mb-2">–ë—ã—Å—Ç—Ä–æ</h3>
            <p class="text-gray-600 text-sm">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞ 1-2 –º–∏–Ω—É—Ç—ã</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl mb-3">üé®</div>
            <h3 class="font-bold text-lg mb-2">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ</h3>
            <p class="text-gray-600 text-sm">–ì–æ—Ç–æ–≤—ã–µ –¥–∏–∑–∞–π–Ω-—à–∞–±–ª–æ–Ω—ã</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
            <div class="text-3xl mb-3">üîí</div>
            <h3 class="font-bold text-lg mb-2">–ë–µ–∑–æ–ø–∞—Å–Ω–æ</h3>
            <p class="text-gray-600 text-sm">OAuth 2.0 –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</p>
        </div>
    </div>

    <!-- Recent Jobs -->
    {% if jobs %}
    <div class="mt-12">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-bold text-gray-900">–ú–æ–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏</h2>
            <a href="/history" class="text-purple-600 hover:text-purple-800 text-sm font-medium">
                –í—Å—è –∏—Å—Ç–æ—Ä–∏—è ‚Üí
            </a>
        </div>
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">–°—Ç–∞—Ç—É—Å</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">–í—Ä–µ–º—è</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for job_id, job in jobs.items() | list | reverse %}{% if loop.index <= 5 %}
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap">
                            {% if job.status == 'completed' %}
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                –ì–æ—Ç–æ–≤–æ
                            </span>
                            {% elif job.status == 'extracted' %}
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
                            </span>
                            {% elif job.status == 'error' %}
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                –û—à–∏–±–∫–∞
                            </span>
                            {% else %}
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                –û–±—Ä–∞–±–æ—Ç–∫–∞...
                            </span>
                            {% endif %}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ job.created_at[:19] if job.created_at else '‚Äî' }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-3">
                            {% if job.status in ['extracted', 'editing', 'completed'] and (job.has_slides or job.slides) %}
                            <a href="/slide_editor?job_id={{ job.id }}" class="text-purple-600 hover:text-purple-900">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä</a>
                            {% endif %}
                            <a href="/job/{{ job.id }}" class="text-blue-600 hover:text-blue-900">–î–µ—Ç–∞–ª–∏</a>
                            {% if job.status == 'completed' and job.generated_presentation_id %}
                            <a href="https://docs.google.com/presentation/d/{{ job.generated_presentation_id }}/edit" target="_blank" class="text-green-600 hover:text-green-900">–û—Ç–∫—Ä—ã—Ç—å ‚Üí</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endif %}{% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
