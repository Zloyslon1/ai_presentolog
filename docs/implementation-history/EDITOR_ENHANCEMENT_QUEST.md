# Quest: –£–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π

## –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Google Slides –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –≤–∏–∑—É–∞–ª—å–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ, –∏ —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é —á–µ—Ä–µ–∑ Google Slides API.

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:
- **Frontend —Ä–µ–¥–∞–∫—Ç–æ—Ä**: `templates/slide_editor.html` (HTML + JavaScript + Tailwind CSS)
- **Backend –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**: `presentation_design/generation/presentation_builder.py` (Python, Google Slides API)
- **Web —Å–µ—Ä–≤–µ—Ä**: `web_app.py` (Flask)

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚úÖ –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è (–∑–∞–≥–æ–ª–æ–≤–æ–∫, –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç)
- ‚úÖ –í—ã–±–æ—Ä —à—Ä–∏—Ñ—Ç–∞ (Google Fonts)
- ‚úÖ –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (–∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–µ–∫—Å—Ç)
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (drag&drop, –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–ª–æ–∏)
- ‚úÖ –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è/–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è)
- ‚ùå **–¢–∞–±–ª–∏—Ü—ã** - UI –µ—Å—Ç—å, –Ω–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- ‚ùå **–í—ã–±–æ—Ä —Ñ–æ–Ω–∞** - –Ω–µ—Ç UI –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- ‚ùå **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞** (bold/italic/underline) - –Ω–µ—Ç
- ‚ùå **–ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ/–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏** - –Ω–µ—Ç
- ‚ùå **–ê–∫—Ü–µ–Ω—Ç–Ω—ã–µ –ø–ª–∞—à–∫–∏** - –Ω–µ—Ç
- ‚ùå **–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞** - UI –µ—Å—Ç—å, –Ω–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ùå **–¶–≤–µ—Ç —à—Ä–∏—Ñ—Ç–∞** - –Ω–µ—Ç
- ‚ùå **–û–¥–Ω–æ—Ç–æ–Ω–Ω—ã–π —Ñ–æ–Ω —Å–ª–∞–π–¥–∞** - –Ω–µ—Ç

---

## –ó–∞–¥–∞—á–∏

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: –í UI –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É" –∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ, –Ω–æ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è.

**Frontend (slide_editor.html)**:
```javascript
// –ù—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é addTable()
function addTable() {
    const rows = parseInt(document.getElementById('tableRows').value);
    const columns = parseInt(document.getElementById('tableColumns').value);
    const x = parseInt(document.getElementById('tableX').value);
    const y = parseInt(document.getElementById('tableY').value);
    const width = parseInt(document.getElementById('tableWidth').value);
    const height = parseInt(document.getElementById('tableHeight').value);
    
    const table = {
        id: 'table_' + Date.now(),
        rows: rows,
        columns: columns,
        position: { x, y },
        size: { width, height },
        cellData: {} // –§–æ—Ä–º–∞—Ç: {"0_0": "—Ç–µ–∫—Å—Ç —è—á–µ–π–∫–∏", "0_1": "—Ç–µ–∫—Å—Ç", ...}
    };
    
    if (!slides[currentSlideIndex].tables) {
        slides[currentSlideIndex].tables = [];
    }
    slides[currentSlideIndex].tables.push(table);
    
    closeTableModal();
    updateTablesList();
    updateSlidePreview();
}
```

**–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å**:
- –†–µ–¥–∞–∫—Ç–æ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —è—á–µ–µ–∫ —Ç–∞–±–ª–∏—Ü—ã (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Å–µ—Ç–∫–æ–π input –ø–æ–ª–µ–π)
- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —Å–ª–∞–π–¥–µ
- –§—É–Ω–∫—Ü–∏—é `updateTablesList()` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç–∞–±–ª–∏—Ü

**Backend (presentation_builder.py)**:
–ú–µ—Ç–æ–¥ `_add_table()` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å—Ç—Ä–æ–∫–∏ 1103-1161), –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è.

---

### 2. –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —Ñ–æ–Ω–∞ —Å–ª–∞–π–¥–∞

**UI (slide_editor.html)** - –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫:
```html
<div class="pt-4 border-t">
    <h3 class="text-sm font-semibold text-gray-700 mb-2">–§–æ–Ω —Å–ª–∞–π–¥–∞</h3>
    
    <!-- –¢–∏–ø —Ñ–æ–Ω–∞ -->
    <div class="space-y-2">
        <label class="flex items-center">
            <input type="radio" name="bgType" value="none" checked onchange="changeBackgroundType('none')">
            <span class="ml-2 text-sm">–ë–µ–∑ —Ñ–æ–Ω–∞ (–±–µ–ª—ã–π)</span>
        </label>
        <label class="flex items-center">
            <input type="radio" name="bgType" value="solid" onchange="changeBackgroundType('solid')">
            <span class="ml-2 text-sm">–û–¥–Ω–æ—Ç–æ–Ω–Ω—ã–π —Ü–≤–µ—Ç</span>
        </label>
        <label class="flex items-center">
            <input type="radio" name="bgType" value="gradient" onchange="changeBackgroundType('gradient')">
            <span class="ml-2 text-sm">–ì—Ä–∞–¥–∏–µ–Ω—Ç</span>
        </label>
    </div>
    
    <!-- –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏ solid) -->
    <div id="solidColorPicker" class="hidden mt-3">
        <label class="block text-xs text-gray-600 mb-1">–¶–≤–µ—Ç —Ñ–æ–Ω–∞</label>
        <input type="color" id="bgColor" value="#FFFFFF" class="w-full h-10 rounded border" onchange="updateBackground()">
    </div>
    
    <!-- –ì—Ä–∞–¥–∏–µ–Ω—Ç (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏ gradient) -->
    <div id="gradientPicker" class="hidden mt-3 space-y-2">
        <div class="flex gap-2">
            <div class="flex-1">
                <label class="block text-xs text-gray-600 mb-1">–¶–≤–µ—Ç 1</label>
                <input type="color" id="gradientColor1" value="#667eea" class="w-full h-8 rounded border" onchange="updateBackground()">
            </div>
            <div class="flex-1">
                <label class="block text-xs text-gray-600 mb-1">–¶–≤–µ—Ç 2</label>
                <input type="color" id="gradientColor2" value="#764ba2" class="w-full h-8 rounded border" onchange="updateBackground()">
            </div>
        </div>
        <select id="gradientDirection" class="w-full p-2 border rounded text-sm" onchange="updateBackground()">
            <option value="to right">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π ‚Üí</option>
            <option value="to bottom">–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π ‚Üì</option>
            <option value="to bottom right">–î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–π ‚Üò</option>
        </select>
    </div>
</div>
```

**JavaScript**:
```javascript
function changeBackgroundType(type) {
    document.getElementById('solidColorPicker').classList.toggle('hidden', type !== 'solid');
    document.getElementById('gradientPicker').classList.toggle('hidden', type !== 'gradient');
    updateBackground();
}

function updateBackground() {
    const bgType = document.querySelector('input[name="bgType"]:checked').value;
    const preview = document.getElementById('slidePreview');
    
    let background = { type: bgType };
    
    if (bgType === 'none') {
        preview.style.background = '#FFFFFF';
        background.color = '#FFFFFF';
    } else if (bgType === 'solid') {
        const color = document.getElementById('bgColor').value;
        preview.style.background = color;
        background.color = color;
    } else if (bgType === 'gradient') {
        const c1 = document.getElementById('gradientColor1').value;
        const c2 = document.getElementById('gradientColor2').value;
        const dir = document.getElementById('gradientDirection').value;
        preview.style.background = `linear-gradient(${dir}, ${c1}, ${c2})`;
        background.gradient = { color1: c1, color2: c2, direction: dir };
    }
    
    slides[currentSlideIndex].background = background;
}
```

**Backend (presentation_builder.py)** - –≤ –º–µ—Ç–æ–¥–µ `_build_advanced_slide_content()`:
```python
# –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ–æ–Ω–∞
background = slide_data.get('background', {})
bg_type = background.get('type', 'none')

if bg_type == 'solid':
    color = background.get('color', '#FFFFFF')
    requests.append({
        'updatePageProperties': {
            'objectId': slide_id,
            'pageProperties': {
                'pageBackgroundFill': {
                    'solidFill': {
                        'color': {
                            'rgbColor': self._hex_to_rgb(color)
                        }
                    }
                }
            },
            'fields': 'pageBackgroundFill'
        }
    })
# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: Google Slides API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –Ω–∞–ø—Ä—è–º—É—é,
# –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-–≥—Ä–∞–¥–∏–µ–Ω—Ç –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ solid
```

---

### 3. –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (Bold/Italic/Underline)

**–ü–æ–¥—Ö–æ–¥**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –≤ —Ç–µ–∫—Å—Ç–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–∞—Ä—Å–∏—Ç—å—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

**UI** - –¥–æ–±–∞–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞–¥ textarea:
```html
<div class="flex gap-1 mb-2 border-b pb-2">
    <button onclick="wrapSelection('**', '**')" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 font-bold" title="–ñ–∏—Ä–Ω—ã–π">B</button>
    <button onclick="wrapSelection('*', '*')" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 italic" title="–ö—É—Ä—Å–∏–≤">I</button>
    <button onclick="wrapSelection('__', '__')" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200 underline" title="–ü–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π">U</button>
    <span class="border-l mx-2"></span>
    <button onclick="insertListMarker('‚Ä¢')" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200" title="–ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫">‚Ä¢ –°–ø–∏—Å–æ–∫</button>
    <button onclick="insertListMarker('1.')" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200" title="–ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫">1. –ù—É–º–µ—Ä–∞—Ü–∏—è</button>
</div>
```

**JavaScript**:
```javascript
function wrapSelection(before, after) {
    const textarea = document.getElementById('mainTextInput');
    const start = textarea.selectionStart;
    const end = textarea.selectionEnd;
    const text = textarea.value;
    const selectedText = text.substring(start, end);
    
    textarea.value = text.substring(0, start) + before + selectedText + after + text.substring(end);
    textarea.selectionStart = start + before.length;
    textarea.selectionEnd = end + before.length;
    textarea.focus();
    
    updateSlidePreview();
}

function insertListMarker(marker) {
    const textarea = document.getElementById('mainTextInput');
    const start = textarea.selectionStart;
    const text = textarea.value;
    
    // –ù–∞–π—Ç–∏ –Ω–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏
    const lineStart = text.lastIndexOf('\n', start - 1) + 1;
    
    textarea.value = text.substring(0, lineStart) + marker + ' ' + text.substring(lineStart);
    textarea.selectionStart = textarea.selectionEnd = start + marker.length + 1;
    textarea.focus();
    
    updateSlidePreview();
}
```

**Backend (presentation_builder.py)** - –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```python
def _parse_formatted_text(self, text: str) -> list:
    """
    –ü–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–æ–≤: [{text, bold, italic, underline}, ...]
    
    –ú–∞—Ä–∫–µ—Ä—ã:
    - **text** = –∂–∏—Ä–Ω—ã–π
    - *text* = –∫—É—Ä—Å–∏–≤  
    - __text__ = –ø–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π
    """
    import re
    
    segments = []
    current_pos = 0
    
    # –ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
    patterns = [
        (r'\*\*(.+?)\*\*', {'bold': True}),
        (r'\*(.+?)\*', {'italic': True}),
        (r'__(.+?)__', {'underline': True}),
    ]
    
    # ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ ...
    
    return segments
```

---

### 4. –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏

**–£–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ** –≤ `formatMainText()` –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞. –ù—É–∂–Ω–æ:

1. –£–ª—É—á—à–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø—Ä–µ–≤—å—é
2. –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–∏—Å–∫–∞—Ö –≤ backend
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Slides API `createParagraphBullets`

**Backend** - –º–µ—Ç–æ–¥ `_apply_list_formatting()` —É–∂–µ –µ—Å—Ç—å (—Å—Ç—Ä–æ–∫–∏ 672-731), –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –µ–≥–æ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–æ–≤.

---

### 5. –î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ü–µ–Ω—Ç–Ω—ã–µ –ø–ª–∞—à–∫–∏ (Highlight Boxes)

**UI** - –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ:
```html
<button onclick="showAccentBoxModal()" class="w-full px-3 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 text-sm">
    üì¶ –î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ü–µ–Ω—Ç–Ω—ã–π –±–ª–æ–∫
</button>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div id="accentBoxModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 max-w-md w-full">
        <h3 class="text-lg font-bold mb-4">–ê–∫—Ü–µ–Ω—Ç–Ω—ã–π –±–ª–æ–∫</h3>
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium mb-2">–¢–µ–∫—Å—Ç</label>
                <textarea id="accentText" rows="3" class="w-full p-2 border rounded"></textarea>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <div>
                    <label class="block text-sm text-gray-600">–¶–≤–µ—Ç —Ñ–æ–Ω–∞</label>
                    <input type="color" id="accentBgColor" value="#E0E7FF" class="w-full h-10 rounded">
                </div>
                <div>
                    <label class="block text-sm text-gray-600">–¶–≤–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã</label>
                    <input type="color" id="accentBorderColor" value="#4F46E5" class="w-full h-10 rounded">
                </div>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <div>
                    <label class="block text-sm text-gray-600">X</label>
                    <input type="number" id="accentX" value="50" class="w-full p-2 border rounded">
                </div>
                <div>
                    <label class="block text-sm text-gray-600">Y</label>
                    <input type="number" id="accentY" value="200" class="w-full p-2 border rounded">
                </div>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <div>
                    <label class="block text-sm text-gray-600">–®–∏—Ä–∏–Ω–∞</label>
                    <input type="number" id="accentWidth" value="300" class="w-full p-2 border rounded">
                </div>
                <div>
                    <label class="block text-sm text-gray-600">–í—ã—Å–æ—Ç–∞</label>
                    <input type="number" id="accentHeight" value="100" class="w-full p-2 border rounded">
                </div>
            </div>
        </div>
        <div class="flex gap-2 mt-6">
            <button onclick="addAccentBox()" class="flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg">–î–æ–±–∞–≤–∏—Ç—å</button>
            <button onclick="closeAccentBoxModal()" class="flex-1 px-4 py-2 bg-gray-300 rounded-lg">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
</div>
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**:
```javascript
{
    id: 'accent_123',
    text: '–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è',
    position: { x: 50, y: 200 },
    size: { width: 300, height: 100 },
    backgroundColor: '#E0E7FF',
    borderColor: '#4F46E5',
    borderWidth: 2,
    borderRadius: 8, // —Å–∫—Ä—É–≥–ª–µ–Ω–∏–µ
    textColor: '#1E1B4B',
    fontSize: 14
}
```

**Backend** - –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `_add_accent_box()`:
```python
def _add_accent_box(self, slide_id: str, box_data: dict, index: int) -> list:
    """–°–æ–∑–¥–∞—ë—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ —Å —Ç–µ–∫—Å—Ç–æ–º (–∞–∫—Ü–µ–Ω—Ç–Ω—ã–π –±–ª–æ–∫)."""
    requests = []
    
    box_id = f"accent_{slide_id}_{index}"
    position = box_data.get('position', {'x': 50, 'y': 200})
    size = box_data.get('size', {'width': 300, 'height': 100})
    bg_color = box_data.get('backgroundColor', '#E0E7FF')
    border_color = box_data.get('borderColor', '#4F46E5')
    text = box_data.get('text', '')
    
    # –°–æ–∑–¥–∞—Ç—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫
    requests.append({
        'createShape': {
            'objectId': box_id,
            'shapeType': 'ROUND_RECTANGLE',
            'elementProperties': {
                'pageObjectId': slide_id,
                'size': {
                    'width': {'magnitude': self._pt_to_emu(size['width']), 'unit': 'EMU'},
                    'height': {'magnitude': self._pt_to_emu(size['height']), 'unit': 'EMU'}
                },
                'transform': {
                    'scaleX': 1,
                    'scaleY': 1,
                    'translateX': self._pt_to_emu(position['x']),
                    'translateY': self._pt_to_emu(position['y']),
                    'unit': 'EMU'
                }
            }
        }
    })
    
    # –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è (—Ñ–æ–Ω + –≥—Ä–∞–Ω–∏—Ü–∞)
    requests.append({
        'updateShapeProperties': {
            'objectId': box_id,
            'shapeProperties': {
                'shapeBackgroundFill': {
                    'solidFill': {
                        'color': {'rgbColor': self._hex_to_rgb(bg_color)}
                    }
                },
                'outline': {
                    'outlineFill': {
                        'solidFill': {
                            'color': {'rgbColor': self._hex_to_rgb(border_color)}
                        }
                    },
                    'weight': {'magnitude': 2, 'unit': 'PT'}
                }
            },
            'fields': 'shapeBackgroundFill,outline'
        }
    })
    
    # –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç
    if text:
        requests.append({
            'insertText': {
                'objectId': box_id,
                'text': text,
                'insertionIndex': 0
            }
        })
    
    return requests
```

---

### 6. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏/–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: UI –∫–Ω–æ–ø–∫–∏ –µ—Å—Ç—å, –Ω–æ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ –ø—Ä–µ–≤—å—é, –Ω–µ –∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏.

**Backend (presentation_builder.py)** - –≤ `_build_advanced_slide_content()`:

–¢–µ–∫—É—â–∏–π –∫–æ–¥ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞. –ù—É–∂–Ω–æ:

1. –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏ –ø–æ–∑–∏—Ü–∏—é —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `contentAlignment` –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö —Ñ–∏–≥—É—Ä—ã

```python
# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –±–ª–æ–∫–∞, –¥–æ–±–∞–≤–∏—Ç—å:
vertical_alignment_map = {
    'top': 'TOP',
    'center': 'MIDDLE', 
    'bottom': 'BOTTOM'
}
vertical = text_position.get('vertical', 'top')

requests.append({
    'updateShapeProperties': {
        'objectId': element_id,
        'shapeProperties': {
            'contentAlignment': vertical_alignment_map.get(vertical, 'TOP')
        },
        'fields': 'contentAlignment'
    }
})
```

---

### 7. –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ —à—Ä–∏—Ñ—Ç–∞

**UI** - –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫:
```html
<div>
    <label class="block text-sm font-medium text-gray-700 mb-2">–¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞</label>
    <div class="flex gap-2">
        <input type="color" id="textColor" value="#000000" class="w-full h-10 rounded border" onchange="changeTextColor()">
        <input type="text" id="textColorHex" value="#000000" class="w-24 p-2 border rounded text-sm font-mono" oninput="syncTextColor()">
    </div>
</div>
```

**JavaScript**:
```javascript
function changeTextColor() {
    const color = document.getElementById('textColor').value;
    document.getElementById('textColorHex').value = color;
    
    // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–≤—å—é
    document.getElementById('previewTitle').style.color = color;
    document.getElementById('previewMain').style.color = color;
    
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–ª–∞–π–¥
    slides[currentSlideIndex].textColor = color;
}

function syncTextColor() {
    const hex = document.getElementById('textColorHex').value;
    if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {
        document.getElementById('textColor').value = hex;
        changeTextColor();
    }
}
```

**Backend** - –≤ `_build_advanced_slide_content()`:
```python
text_color = slide_data.get('textColor', '#000000')

# –í updateTextStyle –¥–æ–±–∞–≤–∏—Ç—å:
'foregroundColor': {
    'opaqueColor': {
        'rgbColor': self._hex_to_rgb(text_color)
    }
}
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–ª–∞–π–¥–∞ (–∏—Ç–æ–≥–æ–≤–∞—è)

```javascript
{
    title: "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
    mainText: "–¢–µ–∫—Å—Ç —Å **—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º** –∏ *–∫—É—Ä—Å–∏–≤–æ–º*",
    secondaryText: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç",
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ä–∏—Ñ—Ç–∞
    fontFamily: "Roboto",
    titleSize: 44,
    textSize: 18,
    textColor: "#333333",
    
    // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
    textPosition: {
        vertical: "top",    // top | center | bottom
        horizontal: "left"  // left | center | right
    },
    
    // –§–æ–Ω
    background: {
        type: "solid",  // none | solid | gradient
        color: "#FFFFFF",
        gradient: { color1: "#667eea", color2: "#764ba2", direction: "to right" }
    },
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã
    images: [...],
    tables: [...],
    arrows: [...],
    accentBoxes: [...]  // –ù–û–í–û–ï
}
```

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–¥–∞—á

1. **–í—ã—Å–æ–∫–∏–π**: –¶–≤–µ—Ç —à—Ä–∏—Ñ—Ç–∞, –æ–¥–Ω–æ—Ç–æ–Ω–Ω—ã–π —Ñ–æ–Ω, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ ‚Äî –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
2. **–°—Ä–µ–¥–Ω–∏–π**: –¢–∞–±–ª–∏—Ü—ã, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ (bold/italic)
3. **–ù–∏–∑–∫–∏–π**: –ê–∫—Ü–µ–Ω—Ç–Ω—ã–µ –ø–ª–∞—à–∫–∏, –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å:
1. –ü—Ä–µ–≤—å—é –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ slides array
3. –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ backend –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
4. Google Slides API –∑–∞–ø—Ä–æ—Å—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
5. –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏

- Google Slides API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç EMU (English Metric Units): 1 PT = 12700 EMU
- –¶–≤–µ—Ç–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ RGB float 0-1, –Ω–µ hex
- –ú–∞–∫—Å–∏–º—É–º 500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω–æ–º batchUpdate
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã —Ñ–æ–Ω–∞ –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è Google Slides API –Ω–∞–ø—Ä—è–º—É—é
